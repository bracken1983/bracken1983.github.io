---
layout:     post
title:      开放封闭原则
subtitle:
date:       2018-02-23
author:     brackenbo
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - 敏捷
    - OCP
    - 开放
    - 封闭
---

# 开放-封闭原则(Open Close Principle: OCP)

### 软件实体(类、模块、函数等等)应该是可以扩展，但是不可修改的。

> 这里的所有观点摘抄自《敏捷软件开发原则、模式与实践》，原著Robert C. Martin，邓辉等译。

## 开放-封闭原则

如果程序中的一处改动会引起系统多个相关模块的改动，那么这个设计就是一个僵化的设计。从OCP的角度，我们应该对这个系统进行重构，以便拥抱变化。

开放-封闭原则设计出的模块，有两个重要的特征：

* 对扩展开放

这怎么理解，例如我们想要去潜水，那么我们并不是把我们的脚，压成鸭子一样的蹼。而是穿上脚蹼。

用书上的话说就是模块的行为可以扩展，当应用需求发生变化时，我们可以对模块进行扩展。

* 对修改封闭

我们不想像金刚狼那样，使得我们的身体变成金属。我们宁愿像钢铁侠，可以穿一身金属。

也就是对模块的源代码不进行修改，变化到来时，只需要利用扩展即可。

## 该如何来做

理论讲完了，那么该如何实现OCP呢？

很简单，就是将变化的部分，作为扩展进行抽象。为什么是抽象，而不是具体某个实现呢？主要我们需要应对变化，既然是变化，就无法和具体的实现对应起来，
所以需要一个抽象的模糊的部分来描述变化的部分。

类比于人类的脚，我们需要应对各种变化（如爬山、跑步等运动方式或者宴会、出行等场合）。所以需要对修改我们的脚封闭，对各种变化的场景扩展，结果是穿上
鞋子--抽象。

OCP常用的方式：

* 组合

听起来是非常基本的OO的概念，但是应用到OCP中来，却需要特别的关注。

正如刚才的例子，我们的脚有鞋子这个抽象，这样在爬山时，我们就可以穿上具体的登山鞋，来完成登山这项运动。

书里面的例子，client类使用了一个抽象类Client Interface，这样具体的client对象就可以使用一个具体的server对象，来实现功能。当我们需要使用不同
的server的时候，只需要替换对应的具体的server对象即可。

* 继承

书中的例子，Policy类预留了具有某种行为的抽象接口。这样在实际使用中，如果需要应对某种变化的Policy，则可以通过派生类的方式来应对。即在派生类中实现
应对变化的具体行为。在C++中，这种方式表现为纯虚函数，JAVA中表现为抽象方法。

在这里是通过继承的方式，来对基类修改进行封闭，对扩展开放。

